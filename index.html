<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <title>krypton</title>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="./styles.css">
    </head>
    <body>
        <div class="maintainer">
            <div class="tbar" id="tabBar">
                <div class="tab active" data-tab-id="1">
                    <div class="tab-fav">
                        <i data-lucide="globe"></i>
                    </div>
                    <span class="tab-tl">New Tab</span>
                    <div class="tab-cl">
                        <i data-lucide="x"></i>
                    </div>
                </div>
                <div class="nt-btn" id="ntBtn">
                    <i data-lucide="plus" style="width: 14px; height: 14px;color: #808080;"></i>
                </div>
            </div>
            <div class="address-bar">
                <button class="nav-btn" id="backBtn" disabled>
                    <i data-lucide="arrow-left"></i>
                </button>
                <button class="nav-btn" id="fwBtn" disabled>
                    <i data-lucide="arrow-right"></i>
                </button>
                <button class="nav-btn" id="refBtn">
                    <i data-lucide="rotate-cw"></i>
                </button>
                <div class="url-intainer">
                    <div class="url-icon">
                        <i data-lucide="lock"></i>
                    </div>
                    <input type="text" class="url-input" placeholder="Search or enter address" id="urlInput">
                </div>
                <button class="nav-btn" id="bmBtn">
                    <i data-lucide="star"></i>
                </button>
                <button class="nav-btn" id="menuBtn">
                    <i data-lucide="more-vertical"></i>
                </button>
            </div>
            <div class="c-area">
                <div class="wscreen">
                    <h1>welcome to krypton.</h1>
                    <p>placeholder, subtitle</p>
                    <div class="shortcuts">
                        <div class="shortcut">
                            <div class="s-icon">
                                <i data-lucide="gamepad-2"></i>
                            </div>
                            <div class="s-title">games</div>
                        </div>
                        <div class="shortcut">
                            <div class="s-icon">
                                <i data-lucide="layout-grid"></i>
                            </div>
                            <div class="s-title">apps</div>
                        </div>
                        <div class="shortcut">
                            <div class="s-icon">
                                <i data-lucide="settings"></i>
                            </div>
                            <div class="s-title">settings</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="https://unpkg.com/lucide@latest"></script>
        <script src="script.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/soap-phia/tinyjet@latest/tinyjet/scramjet.all.js"></script>
        <script type="module">
            import * as BareMux from "https://cdn.jsdelivr.net/npm/@mercuryworkshop/bare-mux/dist/index.mjs";
            async function initProxy() {
                if (!('serviceWorker' in navigator)) {
                    alert('uh oh - SW isnt here? is the page running in a local file?');
                    return;
                }
                const connection = new BareMux.BareMuxConnection("/bareworker.js");
                console.log("baremux connection created");
                await connection.setTransport("https://cdn.jsdelivr.net/npm/@mercuryworkshop/epoxy-transport/dist/index.mjs", [{
                    wisp: "wss://gointospace.app/wisp/"
                }]);
                console.log("baremux wisp transport set");
                await navigator.serviceWorker.register("/sw.js");
                console.log("sw registered");
                await navigator.serviceWorker.ready;
                console.log("sw ready");
                const ScramjetController = (await import("https://cdn.jsdelivr.net/gh/soap-phia/tinyjet@latest/tinyjet/scramjet.all.js")).ScramjetController || window.$scramjetLoadController().ScramjetController;
                const scramjet = new ScramjetController({
                    prefix: "/scramjet/",
                    codec: "xor"
                });
                await scramjet.init();
                console.log("scramjet initialised");
                window.scramjet = scramjet;
                window.proxyReady = true;
                console.log("everything is ready");
            }
            initProxy().catch(e => {
                console.error("init failed ", e);
                console.error("full error: ", e.stack);
            });
        </script>
    </body>
</html>